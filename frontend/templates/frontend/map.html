{% extends 'frontend/base.html' %}
{% block content %}
<main class="container-fluid py-3">
  <div class="row g-3">
    <aside class="col-12 col-lg-3">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h1 class="h4 mb-3">Emergency Services Locator</h1>
          <form id="filters" class="vstack gap-3" aria-describedby="filterHelp">
            <div>
              <label for="type" class="form-label">Service type</label>
              <select id="type" class="form-select" aria-label="Service type">
                <option value="">All</option>
                <option value="hospital">Hospital</option>
                <option value="fire_station">Fire Station</option>
                <option value="police_station">Garda / Police</option>
                <option value="ambulance_base">Ambulance Base</option>
              </select>
            </div>

            <div>
              <label for="radius" class="form-label">Radius (km)</label>
              <input type="range" id="radius" class="form-range" min="1" max="50" value="10">
              <div class="d-flex justify-content-between">
                <span class="text-muted">1</span>
                <span><output id="radiusOut" for="radius">10</output> km</span>
                <span class="text-muted">50</span>
              </div>
            </div>

            <div class="btn-group" role="group" aria-label="Actions">
              <button id="locateBtn" type="button" class="btn btn-primary">Locate me</button>
              <button id="dropPinBtn" type="button" class="btn btn-outline-secondary">Drop pin</button>
            </div>
            
            <div class="btn-group w-100" role="group" aria-label="Search actions">
              <button id="nearestBtn" type="button" class="btn btn-outline-primary">Nearest</button>
              <button id="radiusBtn" type="button" class="btn btn-outline-secondary">Within radius</button>
            </div>

            <hr>

            <!-- County dropdown removed - click counties on map instead -->
            <div class="alert alert-info py-2 px-3 mb-0" role="status">
              <small class="d-block mb-1"><strong>ðŸ’¡ How to use:</strong></small>
              <small class="d-block mb-1">â€¢ Click <strong>Locate me</strong> or <strong>Drop pin</strong> to set your location</small>
              <small class="d-block mb-1">â€¢ Click <strong>Nearest</strong> to find closest facilities</small>
              <small class="d-block mb-1">â€¢ Click <strong>Within radius</strong> to search the area</small>
              <small class="text-muted d-block">â€¢ Click any county on the map to view its facilities</small>
            </div>

            <div class="form-text" id="filterHelp">
              Use the tools above or draw a polygon on the map to filter facilities.
            </div>
          </form>

          <div class="mt-3 small text-muted" aria-live="polite" id="statusMsg">Ready.</div>
        </div>
      </div>
    </aside>

    <section class="col-12 col-lg-9">
      <div id="map" class="rounded shadow-sm" role="application" aria-label="Emergency services map" tabindex="0"></div>
    </section>
  </div>
</main>
{% endblock %}

{% block extra_js %}
{% load static %}
<script type="module" src="{% static 'frontend/js/map.js' %}"></script>
{% endblock %}
